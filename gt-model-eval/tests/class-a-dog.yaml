# Class A Reasoning Tests: Dog
# Fixed neutral role_context â€” no answer hints. Tests raw reasoning from evidence.

- description: "[Class A] Dog orphan: dead assignee, no branch, no commits"
  vars:
    role: dog
    role_context: >
      You are a Dog executing the orphan scan formula. You triage orphaned work items
      by examining session status, git state, and bead metadata. You classify each
      orphan and decide the appropriate action based on the evidence in the shell
      output below.
    formula_step: triage-orphans
    allowed_actions: '["reset", "reassign", "recover", "escalate", "burn"]'
    shell_output: |
      ## Orphan: gt-work1 "Add user roles"
      $ bd show gt-work1 --json
      {"id": "gt-work1", "title": "Add user roles", "status": "in_progress", "assignee": "polecat-Toast"}

      $ tmux has-session -t bd-polecat-Toast 2>/dev/null; echo $?
      1

      $ git branch -a | grep -i "user.roles\|Toast"
      (no output)

      $ ls /town/gastown/polecats/Toast 2>/dev/null
      ls: /town/gastown/polecats/Toast: No such file or directory
    context: ""
  assert:
    - type: javascript
      value: |
        const d = JSON.parse(output);
        return d.action === "reset";

- description: "[Class A] Dog orphan: unpushed commits on local branch"
  vars:
    role: dog
    role_context: >
      You are a Dog executing the orphan scan formula. You triage orphaned work items
      by examining session status, git state, and bead metadata. You classify each
      orphan and decide the appropriate action based on the evidence in the shell
      output below.
    formula_step: triage-orphans
    allowed_actions: '["reset", "reassign", "recover", "escalate", "burn"]'
    shell_output: |
      ## Orphan: gt-work4 "Add search feature"
      $ bd show gt-work4 --json
      {"id": "gt-work4", "title": "Add search feature", "status": "in_progress", "assignee": "polecat-Waffles"}

      $ tmux has-session -t bd-polecat-Waffles 2>/dev/null; echo $?
      1

      $ git -C /town/gastown/polecats/Waffles log --oneline origin/main..HEAD
      a1b2c3d feat: add search endpoint
      d4e5f6g feat: search UI component
      h7i8j9k feat: search indexing
      k0l1m2n test: search integration tests
      o3p4q5r docs: search API documentation

      $ git -C /town/gastown/polecats/Waffles branch -vv | grep '*'
      * feat/search a1b2c3d [no remote] feat: add search endpoint
    context: ""
  assert:
    - type: javascript
      value: |
        const d = JSON.parse(output);
        return d.action === "recover";

- description: "[Class A] Dog orphan: merge conflict state"
  vars:
    role: dog
    role_context: >
      You are a Dog executing the orphan scan formula. You triage orphaned work items
      by examining session status, git state, and bead metadata. You classify each
      orphan and decide the appropriate action based on the evidence in the shell
      output below.
    formula_step: triage-orphans
    allowed_actions: '["reset", "reassign", "recover", "escalate", "burn"]'
    shell_output: |
      ## Orphan: gt-work7 "Database migration"
      $ bd show gt-work7 --json
      {"id": "gt-work7", "title": "Database migration", "status": "in_progress", "assignee": "polecat-Pixel"}

      $ tmux has-session -t bd-polecat-Pixel 2>/dev/null; echo $?
      1

      $ git -C /town/gastown/polecats/Pixel status
      interactive rebase in progress; onto abc1234
      You have unmerged paths.
      Unmerged paths:
        both modified:   src/db/schema.sql
        both modified:   src/db/migrations/001.js
    context: ""
  assert:
    - type: javascript
      value: |
        const d = JSON.parse(output);
        return d.action === "escalate";
